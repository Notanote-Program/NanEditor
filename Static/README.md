# ZZZmaker 基础使用说明

**仅作为交流学习使用，请勿外传。**
版本：1.0.10
最后编辑 2023/1/22

## #0 前置知识，你在制谱之前需要知道的一些事

+ zzz制谱器是一个比较复杂的制谱工具，请按顺序阅读下方说明。读完以后，你将成为zzz制谱大师！
+ 你需要的设备是一个正常的键盘和一个滚轮可以使用的鼠标
+ zzz的屏幕坐标为[-1,1]*[-1,1]，默认的屏幕尺寸比为**16:9**。这点在后续的动画编写环节会再次提到。
+ 制谱器的时间单位是ms，**请尽量不要使用小数时间以免不必要的精度问题**。
+ 你需要把你要写的谱面文件夹放在可执行文件运行目录（即这个目录）中的**Charts**文件夹中。
+ 例如：一个谱面名字为test，那么你需要在Charts文件夹下创建一个test文件夹，在此文件夹中放入一个音频文件（要求为wav或ogg格式）。同时，你需要在test文件夹下创建一个imgs文件夹用于存放谱面中用到的图像资源。

## #1 从这里开始

+ 制谱器由ui部分和主体部分组成。ui可随意拖动到你想放置的任意位置。你可以根据自己的喜好拖动它们到合适的地方，在拖动时，这个视图会被放在ui的最上层。
+ 在第一次开始制谱时，你需要先填写一下谱面的基础信息。有一点需要注意的是，如果你在谱面文件夹中只放了一个音频文件，可以在**音频文件名**一栏填入*，否则你需要填写你想要的音频文件的名字。
+ 完成填写后请点击保存来初始化谱面。保存成功没有提示，你可以检查谱面文件夹，看是否生成了谱面文件（json格式）
+ 保存完成后，请点击加载。加载完成后，下方进度栏左侧会显示歌曲总时长，这代表你成功加载了谱面。
+ 在后续制谱时，你可以仅填写谱面文件夹名和音频文件名并点击加载来获取已经存在的谱面。
+ **每次启动制谱器后，你都需要完成谱面加载！这非常重要，你不希望电脑崩溃，对吧**
+ 如果完成到这一步，恭喜！你已经迈出了zzz制谱的第一步。
+ **你需要在后续放置note之后再调节谱面延迟。延迟大于0代表音乐滞后，小于0代表音乐提前，单位是ms。**

## #2 什么是时间线？

+ 在正式开始制谱之前，你需要了解节拍，时间线以及如何使用他们。点击**时间线管理**，**线密度**表示时间线的疏密情况，**拍分数**表示节拍的细分。
+ 你可以按住左shift键并滚动滚轮来快速编辑时间线密度。
+ 你可以用鼠标左键来选择一条时间线。**这很重要**被选中的时间线会变成亮黄色。
+ 有很多种方式来查看谱面的不同部分。你可以拖动下方进度条，滚动滚轮或者使用鼠标拖动。但是我不建议你使用鼠标拖动，因为处于性能考虑，鼠标拖动并不会真正改变你正在浏览的谱面时间节点。

## #3 播放谱面！fps--

+ 好了，现在你可以播放这个谱面！
+ 看到屏幕下半的白色细线了吗？你的谱面当前播放到这个位置。
+ 点击**播放管理**。播放和暂停用于播放和暂停谱面（这是一句废话）。重置用于将你在谱面上的改动同步到谱面表演部分。
+ 你可以通过按住空格键来播放谱面，松开空格来暂停播放。或者，你可以通过按下一次V开始播放，再次按下V停止播放。你可以通过**S**键来快速返回被选中的时间线的时间。
+ 你可以点击**播放管理**中的显示判定线编号来查看判定线编号。**注意**，因为ui加载原因，目前版本(1.0.1)的判定线编号和判定线中心位置不一定完全对应，可能有一定程度的滞后。如果你发现判定线编号和判定线中心位置不重合，可以尝试对一条选中的时间线多次按**S**来保证同步。
+ 你可以通过按**F**来同步谱面。每次编辑后，在播放谱面之前你最好按一下**F**来同步
+ 你可以按下**H**来隐藏所有UI，再次按下**H**来开启它。这可以用来录制谱面视频。
+ trick：选中一条时间线后，长按空格播放谱面。结束后按**S**，回到开始播放的位置。

## #4 第一个note

+ 是时候放置一些note了。不过在此之前，你需要先确定一条判定线。**判定线从0开始编号。你最好记住每条判定线的编号是什么**
+ 点击**编辑判定线**。你可以添加，删除或选择一条判定线。注意：谱面中至少要存在一条判定线。第一条判定线默认是白色，居中，角度为0。后续增加的判定线默认为透明。（你会在下一节学习如何改变颜色）
+ 你可以用shift加左右方向键来切换上一条或者下一条判定线。对于图像也可以这样快速切换。
+ 选中一条时间线，按下键盘1,2或3来放置note。1代表tap，2代表drag，3代表hold。hold的放置方法有些特殊，你需要按住3，并选择hold结束时间（即再选择一条时间线）再松开3来放置一个hold。如果你直接点按3，会放下一个持续时间为0的hold。
+ 你可以用**右键**选中一个note，或者按住shift用右键选择多个note。按delete键删除它们，请不要一不小心这么干，现在没有撤回功能。
+ 你可以用Ctrl+C选中一个或多个note，选中一条新的时间线，再用Ctrl+V放置它们。你可以使用Ctrl+X进行剪切。Ctrl+D取消选择。
+ 选中一个note，点击**note信息**。你可以编辑这个note的相关信息。点击**设为模板**按钮会让这个note成为模板，之后添加的note会使用模板的颜色，速度等等。
+ note的属性大多是trivial的，只有几个你需要特别注意：引导时间是指note从出生到碰到判定点的间隔时间，默认为2000ms。下落方向指note相对判定点下落的方向，上方或者下方。

## #5 图片

+ 只有判定线的谱面不免乏味。是时候添加一下图像了。
+ 按下Tab键，你会发现**编辑判定线**窗口变为了**编辑图像**。此时你可以开始编辑图像。
+ 默认谱面没有图像，你需要自己添加。点击添加来新建一张图像。你需要先为这张图像取一个名字来记住它。在**修改名称**栏输入名字，你会在上方的下拉选项框看到它。建议你为图像取名有一定意义，因为你需要在下拉框里通过名字选择他们。不要为两张图片取同一个名字，你会搞错的。
+ 现在图像还没有贴图，你需要在下方的图像路径输入图像文件的名称（不需要后缀名，但是图像必须是png格式）来加载一张图像。这个图像应该存储在你的imgs文件夹中。**这个图像文件名和上述图像名字没有关系**
+ 图片默认的生存时间是0到1秒。你可以在完成图片的特效编辑后根据图片特效的起止时间更改图片时间。
+ **图层名**和**图层顺序**用于控制图片的顺序。图层名优先级较高。图层顺序填的数字越大，显示优先级越高。
  + 图层名中，背景层是指在判定线下方；线上方是指介于判定线和Note之间；Note上方是指介于Note和游戏UI（包括进度条、Combo等）之间，UI上方是指介于游戏UI和暂停UI之间。
+ 用**Tab**在**编辑判定线**和**编辑图像**之间切换时，你需要随时注意自己现在在编辑什么。

## #6 来点特效？

+ 终于进入激动人心的特效环节！
+ 选中一条时间线，或者一张图片，你可以按住Q,W,E,R这四个键，像添加hold一样添加特效事件。Q代表移动，W代表旋转，E代表颜色，R代表大小。（大小事件只在图像中出现，判定线没有这种事件）
+ 类似note，你可以选中事件，复制，粘贴，编辑或者删除他们。选中事件后点击**事件管理**来编辑他们。你可以使用Ctrl+A获取当前面板下的所有事件。
+ 移动事件：填写移动的坐标集合。目前你可以使用直线或贝塞尔曲线。**想更好的控制曲线？了解一下贝塞尔曲线！**
  + 移动坐标是控制运动曲线的锚点。你可以点击预览来查看移动轨迹，再次点击预览来关闭它。
  + 移动坐标在屏幕中的范围是-1到1。如果你希望写一个规整的形状（不建议这样做）比如一个圆，可以尝试手动计算坐标。比如，半径为纵轴的0.5,那么半径就是横轴的0.5*9/16。
  + 移动坐标至少需要两个。第一个移动坐标和最后一个坐标代表起点和终点。
  + 不要在一个移动事件里放太多坐标。一般不超过5个。
+ 旋转事件：填写开始和结束的角度。角度采用极坐标系，角度增加为逆时针旋转（这点和Compaz一致）
+ 颜色事件：填写开始和结束的颜色。图像的开始颜色默认为完全透明。
+ X大小事件：填写开始和结束的图片X轴方向上的大小（注意：X轴会跟随图片的旋转而旋转）。默认为1。
+ Y大小事件：填写开始和结束的图片Y轴方向上的大小（注意：Y轴会跟随图片的旋转而旋转）。默认为1。
+ 别忘了编辑缓动类型：
+ 缓动类型由汉字和字母两部分组成，字母内容仅为I、O或IO，其中I表示变快（In），O表示变慢（Out），IO表示先快后慢（InOut），汉字部分与[easing.net](easings.net)的对照如下：
  + Sine-正弦
  + Quad-二次（二次函数）
  + Cubic-三次
  + Quart-四次
  + Quint-五次
  + Expo-指数（以2为底）
  + Circ-椭圆
  + Back-返回
  + Elastic-弹性
  + Bounce-弹跳
+ 谱面信息界面的“开始提示颜色”是游戏本体中进入游戏后的“按任意键开始”的颜色，请根据谱面开头处背景颜色自行决定（一般用纯白或纯黑就行）

## #7 关于SFX文件夹

+ 你可以在SFX里放置tap.wav和drag.wav来达到替换音效的效果，其中tap.wav是tap和hold的音效，drag.wav是drag的音效。
+ 要注意的是如果删掉文件或文件夹，程序找不到文件的情况下会调用默认音效，所以想要达到静音效果请放置静默音频（与zip随包附带的tap.wav和drag.wav就是静默音效）。

## #8 写在最后

+ 这里是你可能会遇到的问题
+ 在点击ui之后，你可能失去焦点导致无法键盘或滚轮输入。点击一下空白处恢复焦点。
+ 添加note或添加事件遵循能加就加原则。如果一个时间或note无法被添加在这个位置上，它就不会被添加成功。
+ 有时候你无法在某个位置添加note或添加事件，这可能是因为时间精度误差导致的。尝试微调这个位置上下紧贴的note或事件的时间（加一或减一），一般能解决问题。
+ 当你编辑note或事件时间时要万分小心，因为如果编辑后的时间不合法（如何其他note或事件时间冲突），它会直接消失。
+ 在编辑note或事件时，请保证你现在已经**选中**了至少一个，否则这次编辑没有意义。

## #8 最后的最后

+ 没有缓存功能，记得随时保存，如果你不放心，可以在其他位置存一个备份。否则如果闪退了**上帝都救不了你**

## 新增编辑

+ 2024/6/25
  + 校准打击特效位置
+ 我丢忘记写UpdateLog了
+ 2024/1/20至2024/6/24
  + 新增大量缓动类型
  + 新增修改开始提示颜色（那个`—— 按任意键开始 ——`的颜色）
  + 新增图片大小事件xy分离
  + 新增设置面板
  + 新增调整制谱器分辨率功能于设置面板，并锁定全屏时比例为16：9
  + 移除单独的历史记录拖动面板，并放入设置面板
  + 修复若干bug
+ 支持Ctrl+S保存谱面
+ 优化了内存回收，如果你仍然觉得遇到卡顿或者内存占用太高请按**O**键强制释放内存。如果这效果不佳，请重启制谱器
+ 2023/2/4
  + 优化了图像加载。现在在高负载情况下按**F**同步不会发生卡顿。
  + 当修改文件夹内图像文件时（如：用新图像覆盖原始图像，删除图像。不包括新增未被引用图像），需要按**I**来重新加载图像文件。这可能导致数秒的卡顿
  + 新增了数值继承功能，新建的事件初始值由相邻事件决定
+ 2023/2/5
  + 元宵快乐！
  + 新增了游玩功能，在播放设置中关闭自动播放，即可进行游玩。全键盘判定。请在游玩时关闭时间线，以增加流畅度
+ 2023/2/7
  + 关闭playerlog。请在你的电脑路径C->user->用户名->appdata->locallow->AmusingGame->Naneditor删除log文件。
+ 2023/2/8
  + 修复图像开始时间问题。
  + 新增连续粘贴功能。复制事件后使用ctrl+shift+v进行粘贴，会令粘贴事件自动延续前一事件。举例：复制旋转事件，从0度到30度，在该事件后粘贴将自动变为30度到60度，以此类推。**颜色事件没有连续粘贴功能**
+ 2023/5/28
  + 新增了自动保存。加载谱面之后，制谱器会每30s保存一次你的谱面到_autosave.json中。如果你意外退出来不及保存，请用_autosave.json替换原先的谱面文件
  + 新增了历史记录，可以存储一定范围内的改动。你可以使用快捷键 **ctrl + z**回退，或者直接从历史记录中点击选择
  + 新增了整体修改，包括整体改变起始位置，角度，具体请见事件管理窗口最下方的设置。特别强调，**翻转**是指将指定坐标变成他的相反数。比如翻转x，那么(0.5,0)会变成(-0.5,0)
  + 新增快捷键，**ctrl + ‘+’**（ctrl和加号键）和**ctrl + ‘-’**（ctrl和减号键）用于快速微调尺寸。你可以选中一个或多个尺寸变换事件，用这两个快捷键来快速变换尺寸，缩放倍数为1.1和0.9.
  + 新增快捷键，**ctrl + 方向键**用于快速改变位置。你可以选中一个或多个移动事件，用这两个快捷键来微调位置，每次调整偏移为0.01.
  + 更改打击音
  + 优化部分逻辑
+ 2023/7/28
  + 自动保存
  + 保存提醒
  + 倍速播放，**shift + ‘上箭头’**加速，**shift + ‘下箭头’**减速
  + 校准长条打击音时间
+ 2023/8/17
  + 取色盘
  + 选择事件和note时自动跳转到对应面板
  + 修改默认排版
+ 2024/1/26
  + 支持按V进行不回溯播放，再次按V暂停
  + 所有预设缓动类型
  + 修复了按Ctrl+S会触发S的同步音画功能的bug